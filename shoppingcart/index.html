<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
     <link rel="manifest" href="/manifest.json">
    <title>Shopping Cart</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <script type="text/javascript">
    	// window.accessToken = '59103148-d338-47c5-a6bd-9ce0e376a0e0'
    	window.lang = 'en_US'
    	window.__is_login__ = true
        window.__isnew = true
    	window.paypalEnv= 'sandbox'
        window.__currency__ = 'USD'
        // window.token = 1

        window.__payimage__ = 'https://s3-us-west-2.amazonaws.com/wanna/pc_default.png'

        window.__country = 'pt_BR'.split('_')[1];

        // https://s3-us-west-2.amazonaws.com/wanna/pt_BR.png

        window.__session_customer__ = {
            id: '123',
            communicationEmail: 'shaolei@163.com'
        }

        if(window.localStorage){
            var dataStr = localStorage.getItem('temp-order')
            localStorage.removeItem('temp-order');
            if(dataStr != null){
                var data = JSON.parse(dataStr)
                window.location.href = 'https://www.chicme.xyz/me/m/order/detail/' + data.data
            }
        }


        


    </script>
</head>
<body style="background-color: #fff;">


    <button id="addtohome">Add to home page</button>
<body>

<script type="text/javascript">
    
     // window.addEventListener('mouseleave', function(){console.log('xxx')}, false)
</script>


<script src="https://www.paypalobjects.com/api/checkout.js"></script>
<script src="https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js"></script>

<script type="text/javascript">
	Mercadopago.setPublishableKey('TEST-aa971175-51cd-4be7-8ae4-f12006ac536d')
</script>



<script type="text/javascript">
    
    window.sendEvent = function(data){
        console.log(data)
    }
</script>

<!-- <script src="https://js-sandbox.dlocal.com"></script> -->



<script type="text/javascript">
    /**
     * Created by shao_ on 2017/9/30.
     */

    (function () {

        function registerServiceWorker() {
            return navigator.serviceWorker.register('/sw2.js',{
                 scope: '.'
            }).then(function (registration) {
                console.log('Service worker successfully registered.')
                return registration
            }).catch(function (err) {
                console.error('Unable to register service worker.', err)
            })
        }


        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function () {
                registerServiceWorker().then(function(registration){
                    alert('sw2')
                    console.log(registration);
                });
            })
        }
    })();

        
    var deferredPrompt, btnAdd = document.getElementById("addtohome");

    window.addEventListener('beforeinstallprompt', (e) => {
         alert('fuck2');
      // Prevent Chrome 67 and earlier from automatically showing the prompt
      e.preventDefault();
      // Stash the event so it can be triggered later.
      deferredPrompt = e;
      // Update UI notify the user they can add to home screen
      btnAdd.style.display = 'block';
     
    });
    
    
    btnAdd.addEventListener('click', (e) => {
      // hide our user interface that shows our A2HS button
      btnAdd.style.display = 'none';
      // Show the prompt
      deferredPrompt.prompt();
      // Wait for the user to respond to the prompt
      deferredPrompt.userChoice
        .then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the A2HS prompt');
          } else {
            console.log('User dismissed the A2HS prompt');
          }
          deferredPrompt = null;
        });
    });
    
    window.addEventListener('appinstalled', (evt) => {
         alert('Installed');
         app.logEvent('a2hs', 'installed');
    });
    
    
</script>


</body>
</html>
